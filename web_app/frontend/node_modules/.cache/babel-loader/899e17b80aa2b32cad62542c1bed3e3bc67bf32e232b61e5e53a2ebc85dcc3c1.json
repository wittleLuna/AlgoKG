{"ast":null,"code":"import React,{useState}from'react';import{Button,Card,Input,Space,message}from'antd';import{UserOutlined,LikeOutlined}from'@ant-design/icons';import LoginModal from'./LoginModal';// 引入 LoginModal 组件\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Login=_ref=>{let{onLoginSuccess}=_ref;const[loading,setLoading]=useState(false);const[formData,setFormData]=useState({username:'',password:''});const[visible,setVisible]=useState(false);// 控制 LoginModal 的显示\nconst handleInputChange=(field,value)=>{setFormData(prev=>({...prev,[field]:value}));};const handleLogin=async()=>{if(!formData.username.trim()||!formData.password.trim()){message.error('请输入用户名和密码');return;}setLoading(true);try{const response=await fetch('/api/v1/auth/login',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({username:formData.username,password:formData.password})});if(!response.ok){const errorData=await response.json();throw new Error(errorData.detail||'登录失败');}const data=await response.json();// 保存令牌\nlocalStorage.setItem('token',data.access_token);localStorage.setItem('user',JSON.stringify(data.user));message.success('登录成功！');if(onLoginSuccess){onLoginSuccess(data.access_token,data.user);}}catch(error){console.error('登录失败:',error);message.error(error.message||'登录失败，请重试');}finally{setLoading(false);}};const showLoginModal=()=>{setVisible(true);// 打开 LoginModal 模态框\n};const closeLoginModal=()=>{setVisible(false);// 关闭 LoginModal 模态框\n};return/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'center',alignItems:'center',minHeight:'60vh',padding:'20px'},children:[/*#__PURE__*/_jsx(Card,{title:\"\\u7528\\u6237\\u767B\\u5F55\",style:{width:400},children:/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',flexDirection:'column',gap:'16px'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'4px',fontWeight:'bold'},children:\"\\u7528\\u6237\\u540D\"}),/*#__PURE__*/_jsx(Input,{prefix:/*#__PURE__*/_jsx(UserOutlined,{}),placeholder:\"\\u8BF7\\u8F93\\u5165\\u7528\\u6237\\u540D\",value:formData.username,onChange:e=>handleInputChange('username',e.target.value)})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:'4px',fontWeight:'bold'},children:\"\\u5BC6\\u7801\"}),/*#__PURE__*/_jsx(Input,{type:\"password\",prefix:/*#__PURE__*/_jsx(LikeOutlined,{}),placeholder:\"\\u8BF7\\u8F93\\u5165\\u5BC6\\u7801\",value:formData.password,onChange:e=>handleInputChange('password',e.target.value)})]}),/*#__PURE__*/_jsx(Space,{direction:\"vertical\",style:{width:'100%'},children:/*#__PURE__*/_jsx(Button,{type:\"primary\",loading:loading,onClick:handleLogin,style:{width:'100%'},children:\"\\u767B\\u5F55\"})}),/*#__PURE__*/_jsx(Button,{type:\"link\",onClick:showLoginModal// 显示 LoginModal\n,style:{color:'#1890ff',fontSize:'14px',marginTop:'10px'},children:\"\\u7ACB\\u5373\\u6CE8\\u518C\"})]})}),/*#__PURE__*/_jsx(LoginModal,{visible:visible,onClose:closeLoginModal// 关闭模态框\n,onSuccess:()=>console.log('成功登录或注册')})]});};export default Login;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}