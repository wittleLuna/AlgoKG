{"ast":null,"code":"import React,{useState}from'react';import{Typography,Card,Space,Button,Input,message,Spin,Empty}from'antd';import{SearchOutlined,NodeIndexOutlined}from'@ant-design/icons';import UnifiedGraphVisualization from'../components/graph/UnifiedGraphVisualization';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const{Title,Paragraph,Text}=Typography;const{Search}=Input;const UnifiedGraphPage=()=>{const[graphData,setGraphData]=useState();const[selectedNode,setSelectedNode]=useState(null);const[loading,setLoading]=useState(false);const[currentEntity,setCurrentEntity]=useState('');const[searchHistory,setSearchHistory]=useState([]);// 查询实体图谱\nconst handleSearch=async entity=>{if(!entity.trim()){message.warning('请输入要查询的实体名称');return;}setLoading(true);setCurrentEntity(entity.trim());try{// 调用统一图谱API\nconst response=await fetch('/api/v1/graph/unified/query?data_sources=neo4j&data_sources=embedding',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({entity_name:entity.trim(),depth:2,limit:50})});if(!response.ok){throw new Error(`查询失败: ${response.status}`);}const data=await response.json();setGraphData(data);// 添加到搜索历史\nsetSearchHistory(prev=>{const newHistory=[entity.trim(),...prev.filter(h=>h!==entity.trim())];return newHistory.slice(0,10);// 保留最近10次搜索\n});message.success(`成功加载 \"${entity}\" 的知识图谱`);}catch(error){console.error('查询图谱失败:',error);message.error('查询图谱失败，请稍后重试');setGraphData(undefined);}finally{setLoading(false);}};// 处理节点点击\nconst handleNodeClick=(nodeId,nodeData)=>{setSelectedNode(nodeData);console.log('节点点击:',nodeId,nodeData);};// 示例查询\nconst exampleQueries=['动态规划','两数之和','链表','二分查找','贪心算法','回溯算法'];return/*#__PURE__*/_jsxs(\"div\",{style:{height:'calc(100vh - 120px)',display:'flex',flexDirection:'column',padding:'24px',overflow:'auto'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:24,flexShrink:0},children:[/*#__PURE__*/_jsxs(Title,{level:2,children:[/*#__PURE__*/_jsx(NodeIndexOutlined,{style:{marginRight:8}}),\"\\u77E5\\u8BC6\\u56FE\\u8C31\"]}),/*#__PURE__*/_jsx(Paragraph,{type:\"secondary\",children:\"\\u8F93\\u5165\\u5B9E\\u4F53\\u540D\\u79F0\\uFF0C\\u67E5\\u770B\\u4EE5\\u8BE5\\u5B9E\\u4F53\\u4E3A\\u6838\\u5FC3\\u7684\\u77E5\\u8BC6\\u56FE\\u8C31\"})]}),/*#__PURE__*/_jsx(Card,{style:{marginBottom:24,flexShrink:0},children:/*#__PURE__*/_jsxs(Space,{direction:\"vertical\",style:{width:'100%'},children:[/*#__PURE__*/_jsx(Search,{placeholder:\"\\u8BF7\\u8F93\\u5165\\u8981\\u67E5\\u8BE2\\u7684\\u5B9E\\u4F53\\u540D\\u79F0\\uFF0C\\u5982\\uFF1A\\u52A8\\u6001\\u89C4\\u5212\\u3001\\u4E24\\u6570\\u4E4B\\u548C\\u3001\\u94FE\\u8868\\u7B49\",enterButton:/*#__PURE__*/_jsx(Button,{type:\"primary\",icon:/*#__PURE__*/_jsx(SearchOutlined,{}),children:\"\\u67E5\\u8BE2\\u56FE\\u8C31\"}),size:\"large\",onSearch:handleSearch,loading:loading}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Text,{type:\"secondary\",style:{marginRight:8},children:\"\\u5FEB\\u901F\\u67E5\\u8BE2:\"}),/*#__PURE__*/_jsx(Space,{wrap:true,children:exampleQueries.map(query=>/*#__PURE__*/_jsx(Button,{size:\"small\",type:\"link\",onClick:()=>handleSearch(query),disabled:loading,children:query},query))})]}),searchHistory.length>0&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Text,{type:\"secondary\",style:{marginRight:8},children:\"\\u6700\\u8FD1\\u67E5\\u8BE2:\"}),/*#__PURE__*/_jsx(Space,{wrap:true,children:searchHistory.slice(0,5).map(query=>/*#__PURE__*/_jsx(Button,{size:\"small\",type:\"text\",onClick:()=>handleSearch(query),disabled:loading,children:query},query))})]})]})}),/*#__PURE__*/_jsx(\"div\",{style:{flex:1,minHeight:'800px',overflow:'visible'},children:loading?/*#__PURE__*/_jsxs(Card,{style:{height:'100%',display:'flex',alignItems:'center',justifyContent:'center',flexDirection:'column'},children:[/*#__PURE__*/_jsx(Spin,{size:\"large\"}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:16,textAlign:'center'},children:/*#__PURE__*/_jsx(Text,{children:\"\\u6B63\\u5728\\u52A0\\u8F7D\\u56FE\\u8C31\\u6570\\u636E...\"})})]}):graphData?/*#__PURE__*/_jsx(Card,{title:/*#__PURE__*/_jsxs(Space,{children:[/*#__PURE__*/_jsx(NodeIndexOutlined,{}),/*#__PURE__*/_jsx(Text,{strong:true,children:currentEntity}),/*#__PURE__*/_jsx(Text,{type:\"secondary\",children:\"\\u7684\\u77E5\\u8BC6\\u56FE\\u8C31\"})]}),style:{height:'800px',overflow:'visible'},bodyStyle:{height:'calc(800px - 57px)',padding:0,overflow:'visible'},children:/*#__PURE__*/_jsx(UnifiedGraphVisualization,{data:graphData,onNodeClick:handleNodeClick,height:\"100%\",showControls:true,defaultDataSources:['neo4j','embedding'],disableBuiltinNodeDetail:true})}):/*#__PURE__*/_jsx(Card,{style:{height:'100%',display:'flex',alignItems:'center',justifyContent:'center',flexDirection:'column'},children:/*#__PURE__*/_jsx(Empty,{description:\"\\u8BF7\\u8F93\\u5165\\u5B9E\\u4F53\\u540D\\u79F0\\u5F00\\u59CB\\u63A2\\u7D22\\u77E5\\u8BC6\\u56FE\\u8C31\"})})})]});};export default UnifiedGraphPage;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}