{"ast":null,"code":"import React,{useState}from'react';import{Card,Tag,Space,Button,Collapse}from'antd';import{NodeIndexOutlined,LinkOutlined,BulbOutlined}from'@ant-design/icons';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const{Panel}=Collapse;const EntityDetailPanel=_ref=>{let{entities,relations,entityDetails,noteId}=_ref;const[expandedEntities,setExpandedEntities]=useState([]);const[loading,setLoading]=useState(false);const getEntityTypeColor=type=>{const colorMap={'algorithm_paradigm':'blue','data_structure':'green','technique':'orange','problem_type':'purple','complexity':'red','default':'default'};return colorMap[type]||colorMap.default;};const getEntityTypeLabel=type=>{const labelMap={'algorithm_paradigm':'算法范式','data_structure':'数据结构','technique':'算法技巧','problem_type':'问题类型','complexity':'复杂度'};return labelMap[type]||type;};const getStatusColor=status=>{const colors={'new':'green','enhanced':'blue','existing':'orange'};return colors[status]||'default';};const getStatusText=status=>{const texts={'new':'新增实体','enhanced':'增强实体','existing':'已存在'};return texts[status]||status;};const getRelatedRelations=entityId=>{return relations.filter(rel=>rel.source===entityId||rel.target===entityId);};const getEntityDetail=entityId=>{return entityDetails.find(detail=>detail.entity.id===entityId);};const handleEntityExpand=entityId=>{setExpandedEntities(prev=>prev.includes(entityId)?prev.filter(id=>id!==entityId):[...prev,entityId]);};const renderEntityCard=entity=>{const detail=getEntityDetail(entity.id);const relatedRelations=getRelatedRelations(entity.id);const isExpanded=expandedEntities.includes(entity.id);return/*#__PURE__*/_jsxs(Card,{size:\"small\",style:{marginBottom:'12px'},title:/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',justifyContent:'space-between'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'8px'},children:[/*#__PURE__*/_jsx(NodeIndexOutlined,{}),/*#__PURE__*/_jsx(\"span\",{children:entity.name}),/*#__PURE__*/_jsx(Tag,{color:getEntityTypeColor(entity.type),children:getEntityTypeLabel(entity.type)}),detail&&/*#__PURE__*/_jsx(Tag,{color:getStatusColor(detail.graph_status),children:getStatusText(detail.graph_status)})]}),/*#__PURE__*/_jsx(Button,{type:\"text\",size:\"small\",onClick:()=>handleEntityExpand(entity.id),children:isExpanded?'收起':'展开'})]}),children:[/*#__PURE__*/_jsx(\"div\",{style:{marginBottom:'8px'},children:/*#__PURE__*/_jsxs(Space,{children:[/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u7F6E\\u4FE1\\u5EA6:\"}),\" \",Math.round(entity.confidence*100),\"%\"]}),relatedRelations.length>0&&/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u5173\\u7CFB\\u6570:\"}),\" \",relatedRelations.length]})]})}),entity.description&&/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'8px'},children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u63CF\\u8FF0:\"}),\" \",entity.description]}),isExpanded&&detail&&/*#__PURE__*/_jsxs(\"div\",{children:[detail.related_concepts.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'12px'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'4px',marginBottom:'4px'},children:[/*#__PURE__*/_jsx(BulbOutlined,{}),/*#__PURE__*/_jsx(\"strong\",{children:\"\\u76F8\\u5173\\u6982\\u5FF5:\"})]}),/*#__PURE__*/_jsx(Space,{wrap:true,children:detail.related_concepts.map((concept,index)=>/*#__PURE__*/_jsx(Tag,{color:\"cyan\",style:{cursor:'pointer'},children:concept},index))})]}),detail.integration_path.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'12px'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'4px',marginBottom:'4px'},children:[/*#__PURE__*/_jsx(LinkOutlined,{}),/*#__PURE__*/_jsx(\"strong\",{children:\"\\u77E5\\u8BC6\\u56FE\\u8C31\\u8DEF\\u5F84:\"})]}),/*#__PURE__*/_jsx(\"div\",{style:{padding:'8px',backgroundColor:'#f5f5f5',borderRadius:'4px',fontFamily:'monospace'},children:detail.integration_path.join(' → ')})]}),relatedRelations.length>0&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u76F8\\u5173\\u5173\\u7CFB:\"}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:'8px'},children:relatedRelations.map((relation,index)=>{const isSource=relation.source===entity.id;const otherEntityId=isSource?relation.target:relation.source;const otherEntity=entities.find(e=>e.id===otherEntityId);return/*#__PURE__*/_jsxs(\"div\",{style:{padding:'6px 8px',backgroundColor:'#f9f9f9',borderRadius:'4px',marginBottom:'4px',fontSize:'12px'},children:[isSource?/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:entity.name}),/*#__PURE__*/_jsx(\"span\",{style:{margin:'0 8px',color:'#666'},children:relation.type}),/*#__PURE__*/_jsx(\"strong\",{children:(otherEntity===null||otherEntity===void 0?void 0:otherEntity.name)||otherEntityId})]}):/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:(otherEntity===null||otherEntity===void 0?void 0:otherEntity.name)||otherEntityId}),/*#__PURE__*/_jsx(\"span\",{style:{margin:'0 8px',color:'#666'},children:relation.type}),/*#__PURE__*/_jsx(\"strong\",{children:entity.name})]}),/*#__PURE__*/_jsxs(\"span\",{style:{marginLeft:'8px',color:'#999'},children:[\"(\",Math.round(relation.confidence*100),\"%)\"]})]},index);})})]})]})]},entity.id);};const groupedEntities=entities.reduce((groups,entity)=>{const type=entity.type;if(!groups[type]){groups[type]=[];}groups[type].push(entity);return groups;},{});return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{style:{marginBottom:'16px'},children:/*#__PURE__*/_jsxs(Space,{children:[/*#__PURE__*/_jsxs(Tag,{color:\"blue\",children:[\"\\u603B\\u5B9E\\u4F53: \",entities.length]}),/*#__PURE__*/_jsxs(Tag,{color:\"purple\",children:[\"\\u5173\\u7CFB: \",relations.length]}),/*#__PURE__*/_jsx(Button,{size:\"small\",onClick:()=>setExpandedEntities(entities.map(e=>e.id)),children:\"\\u5168\\u90E8\\u5C55\\u5F00\"}),/*#__PURE__*/_jsx(Button,{size:\"small\",onClick:()=>setExpandedEntities([]),children:\"\\u5168\\u90E8\\u6536\\u8D77\"})]})}),/*#__PURE__*/_jsx(Collapse,{defaultActiveKey:Object.keys(groupedEntities),children:Object.entries(groupedEntities).map(_ref2=>{let[type,typeEntities]=_ref2;return/*#__PURE__*/_jsx(Panel,{header:/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'8px'},children:[/*#__PURE__*/_jsx(Tag,{color:getEntityTypeColor(type),children:getEntityTypeLabel(type)}),/*#__PURE__*/_jsxs(\"span\",{children:[\"(\",typeEntities.length,\" \\u4E2A\\u5B9E\\u4F53)\"]})]}),children:typeEntities.map(entity=>renderEntityCard(entity))},type);})})]});};export default EntityDetailPanel;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}