{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Card,List,Button,Tag,Space,Typography,Tooltip,Popover,Progress}from'antd';import{BulbOutlined,QuestionCircleOutlined,RightOutlined,StarOutlined,TrophyOutlined,InfoCircleOutlined}from'@ant-design/icons';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const{Text,Title}=Typography;const SmartLinkSuggestions=_ref=>{let{response,onConceptClick,onProblemClick,className}=_ref;const[suggestions,setSuggestions]=useState([]);const[loading,setLoading]=useState(false);// 生成智能建议\nconst generateSuggestions=response=>{var _response$example_pro,_response$similar_pro;const suggestions=[];// 基于概念解释生成建议\nif(response.concept_explanation){var _concept$learning_pro,_concept$learning_pro2,_concept$clickable_co;const concept=response.concept_explanation;// 前置概念建议\nconst prerequisites=((_concept$learning_pro=concept.learning_progression)===null||_concept$learning_pro===void 0?void 0:_concept$learning_pro.prerequisites)||[];prerequisites.forEach((prereq,index)=>{suggestions.push({id:`prereq-${index}`,title:prereq,type:'concept',description:`学习${concept.concept_name}的前置知识`,tags:['前置知识','基础'],relevance:0.9,reason:'掌握前置知识有助于更好理解当前概念'});});// 后续概念建议\nconst nextConcepts=((_concept$learning_pro2=concept.learning_progression)===null||_concept$learning_pro2===void 0?void 0:_concept$learning_pro2.next_concepts)||[];nextConcepts.forEach((next,index)=>{suggestions.push({id:`next-${index}`,title:next,type:'concept',description:`${concept.concept_name}的进阶学习`,tags:['进阶','拓展'],relevance:0.8,reason:'继续深入学习相关高级概念'});});// 相似概念建议\n(_concept$clickable_co=concept.clickable_concepts)===null||_concept$clickable_co===void 0?void 0:_concept$clickable_co.forEach((similar,index)=>{if(!prerequisites.includes(similar)&&!nextConcepts.includes(similar)){suggestions.push({id:`similar-${index}`,title:similar,type:'concept',description:`与${concept.concept_name}相关的概念`,tags:['相关概念'],relevance:0.7,reason:'了解相关概念有助于建立知识体系'});}});}// 基于示例题目生成建议\n(_response$example_pro=response.example_problems)===null||_response$example_pro===void 0?void 0:_response$example_pro.forEach((problem,index)=>{if(problem.clickable){suggestions.push({id:`example-${index}`,title:problem.title,type:'problem',description:problem.description||'相关练习题目',difficulty:problem.difficulty,tags:[...problem.algorithm_tags,...problem.data_structure_tags],relevance:0.85,reason:'通过练习加深理解'});}});// 基于相似题目生成建议\n(_response$similar_pro=response.similar_problems)===null||_response$similar_pro===void 0?void 0:_response$similar_pro.forEach((similar,index)=>{if(similar.clickable){var _similar$complete_inf;suggestions.push({id:`similar-problem-${index}`,title:similar.title,type:'problem',description:similar.recommendation_reason,difficulty:(_similar$complete_inf=similar.complete_info)===null||_similar$complete_inf===void 0?void 0:_similar$complete_inf.difficulty,tags:similar.shared_tags,relevance:similar.hybrid_score,reason:similar.learning_path_explanation});}});// 基于实体生成学习路径建议\nif(response.entities&&response.entities.length>0){const mainEntity=response.entities[0];suggestions.push({id:'learning-path',title:`${mainEntity}学习路径`,type:'learning_path',description:`系统学习${mainEntity}的完整路径`,tags:['学习路径','系统学习'],relevance:0.9,reason:'系统性学习能够建立完整的知识体系'});}// 按相关性排序并去重\nconst uniqueSuggestions=suggestions.filter((suggestion,index,self)=>index===self.findIndex(s=>s.title===suggestion.title&&s.type===suggestion.type));return uniqueSuggestions.sort((a,b)=>b.relevance-a.relevance).slice(0,8);// 限制建议数量\n};// 当响应变化时更新建议\nuseEffect(()=>{if(response){setLoading(true);// 模拟异步处理\nsetTimeout(()=>{const newSuggestions=generateSuggestions(response);setSuggestions(newSuggestions);setLoading(false);},500);}},[response]);// 获取类型图标\nconst getTypeIcon=type=>{const iconMap={'concept':/*#__PURE__*/_jsx(BulbOutlined,{style:{color:'#1890ff'}}),'problem':/*#__PURE__*/_jsx(QuestionCircleOutlined,{style:{color:'#fa8c16'}}),'learning_path':/*#__PURE__*/_jsx(TrophyOutlined,{style:{color:'#52c41a'}})};return iconMap[type]||/*#__PURE__*/_jsx(BulbOutlined,{});};// 获取难度颜色\nconst getDifficultyColor=difficulty=>{const colorMap={'简单':'green','中等':'orange','困难':'red'};return colorMap[difficulty||'']||'default';};// 生成详细信息的Popover内容\nconst getDetailedPopoverContent=suggestion=>{return/*#__PURE__*/_jsxs(\"div\",{style:{maxWidth:300},children:[/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:12},children:[/*#__PURE__*/_jsx(Text,{strong:true,children:suggestion.title}),suggestion.difficulty&&/*#__PURE__*/_jsx(Tag,{color:getDifficultyColor(suggestion.difficulty),style:{marginLeft:8},children:suggestion.difficulty})]}),suggestion.description&&/*#__PURE__*/_jsx(\"div\",{style:{marginBottom:8},children:/*#__PURE__*/_jsx(Text,{type:\"secondary\",children:suggestion.description})}),suggestion.relevance&&/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:8},children:[/*#__PURE__*/_jsx(Text,{strong:true,children:\"\\u76F8\\u5173\\u6027: \"}),/*#__PURE__*/_jsx(Progress,{percent:Math.round(suggestion.relevance*100),size:\"small\",showInfo:false,style:{width:100,display:'inline-block',marginLeft:4}}),/*#__PURE__*/_jsxs(Text,{type:\"secondary\",style:{marginLeft:8},children:[(suggestion.relevance*100).toFixed(1),\"%\"]})]}),suggestion.tags&&suggestion.tags.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:8},children:[/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:4},children:[/*#__PURE__*/_jsx(StarOutlined,{style:{marginRight:4}}),/*#__PURE__*/_jsx(Text,{strong:true,children:\"\\u6807\\u7B7E:\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[suggestion.tags.slice(0,5).map((tag,index)=>/*#__PURE__*/_jsx(Tag,{size:\"small\",style:{marginBottom:2},children:tag},index)),suggestion.tags.length>5&&/*#__PURE__*/_jsxs(Text,{type:\"secondary\",children:[\"+\",suggestion.tags.length-5,\"\\u4E2A\"]})]})]}),suggestion.reason&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Text,{strong:true,children:\"\\u63A8\\u8350\\u7406\\u7531: \"}),/*#__PURE__*/_jsx(Text,{type:\"secondary\",children:suggestion.reason})]})]});};// 处理点击事件\nconst handleSuggestionClick=suggestion=>{// 添加点击反馈\nconst clickedElement=document.querySelector(`[data-suggestion-id=\"${suggestion.id}\"]`);if(clickedElement){clickedElement.classList.add('suggestion-clicked');setTimeout(()=>{clickedElement.classList.remove('suggestion-clicked');},300);}switch(suggestion.type){case'concept':if(onConceptClick){onConceptClick(suggestion.title);}break;case'problem':if(onProblemClick){onProblemClick(suggestion.title);}break;case'learning_path':// 可以触发学习路径查询\nif(onConceptClick){onConceptClick(`${suggestion.title.replace('学习路径','')}的学习路径`);}break;}};if(!response||suggestions.length===0){return null;}return/*#__PURE__*/_jsxs(Card,{className:`smart-link-suggestions ${className||''}`,title:/*#__PURE__*/_jsxs(Space,{children:[/*#__PURE__*/_jsx(StarOutlined,{style:{color:'#faad14'}}),/*#__PURE__*/_jsx(Title,{level:5,style:{margin:0},children:\"\\u667A\\u80FD\\u63A8\\u8350\"})]}),size:\"small\",loading:loading,children:[/*#__PURE__*/_jsx(List,{size:\"small\",dataSource:suggestions,renderItem:suggestion=>/*#__PURE__*/_jsx(List.Item,{className:\"suggestion-item\",\"data-suggestion-id\":suggestion.id,onClick:()=>handleSuggestionClick(suggestion),children:/*#__PURE__*/_jsxs(\"div\",{className:\"suggestion-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"suggestion-header\",children:[/*#__PURE__*/_jsxs(Space,{children:[getTypeIcon(suggestion.type),/*#__PURE__*/_jsx(Text,{strong:true,className:\"suggestion-title\",children:suggestion.title}),suggestion.difficulty&&/*#__PURE__*/_jsx(Tag,{color:getDifficultyColor(suggestion.difficulty),style:{fontSize:'12px'},children:suggestion.difficulty})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"suggestion-actions\",children:[/*#__PURE__*/_jsx(Tooltip,{title:`相关性: ${(suggestion.relevance*100).toFixed(0)}%`,children:/*#__PURE__*/_jsx(\"div\",{className:\"relevance-indicator\",children:/*#__PURE__*/_jsx(\"div\",{className:\"relevance-bar\",style:{width:`${suggestion.relevance*100}%`}})})}),/*#__PURE__*/_jsxs(Space,{children:[/*#__PURE__*/_jsx(Popover,{content:getDetailedPopoverContent(suggestion),title:\"\\u8BE6\\u7EC6\\u4FE1\\u606F\",trigger:\"hover\",placement:\"topRight\",children:/*#__PURE__*/_jsx(Button,{type:\"text\",size:\"small\",icon:/*#__PURE__*/_jsx(InfoCircleOutlined,{}),className:\"suggestion-info-button\",onClick:e=>e.stopPropagation()})}),/*#__PURE__*/_jsx(Button,{type:\"text\",size:\"small\",icon:/*#__PURE__*/_jsx(RightOutlined,{}),className:\"suggestion-button\"})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"suggestion-description\",children:/*#__PURE__*/_jsx(Text,{type:\"secondary\",style:{fontSize:12},children:suggestion.description})}),suggestion.tags.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"suggestion-tags\",children:suggestion.tags.slice(0,3).map((tag,index)=>/*#__PURE__*/_jsx(Tag,{color:\"blue\",style:{fontSize:'12px'},children:tag},index))}),/*#__PURE__*/_jsx(\"div\",{className:\"suggestion-reason\",children:/*#__PURE__*/_jsxs(Text,{type:\"secondary\",style:{fontSize:11,fontStyle:'italic'},children:[\"\\uD83D\\uDCA1 \",suggestion.reason]})})]})})}),/*#__PURE__*/_jsx(\"style\",{jsx:true,children:`\n        .smart-link-suggestions {\n          margin-top: 16px;\n          border: 1px solid #e8f4fd;\n          background: linear-gradient(135deg, #f6f9fc 0%, #ffffff 100%);\n        }\n\n        .suggestion-item {\n          cursor: pointer;\n          transition: all 0.2s ease;\n          border-radius: 6px;\n          margin-bottom: 4px;\n          padding: 8px !important;\n        }\n\n        .suggestion-item:hover {\n          background: rgba(24, 144, 255, 0.05);\n          transform: translateX(4px);\n          box-shadow: 0 2px 8px rgba(24, 144, 255, 0.1);\n        }\n\n        .suggestion-item.suggestion-clicked {\n          background: rgba(24, 144, 255, 0.1);\n          transform: scale(0.98);\n          box-shadow: 0 0 0 2px #1890ff;\n        }\n\n        .suggestion-content {\n          width: 100%;\n        }\n\n        .suggestion-header {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          margin-bottom: 4px;\n        }\n\n        .suggestion-title {\n          color: #1890ff;\n          font-size: 13px;\n        }\n\n        .suggestion-actions {\n          display: flex;\n          align-items: center;\n          gap: 8px;\n        }\n\n        .relevance-indicator {\n          width: 40px;\n          height: 4px;\n          background: #f0f0f0;\n          border-radius: 2px;\n          overflow: hidden;\n        }\n\n        .relevance-bar {\n          height: 100%;\n          background: linear-gradient(90deg, #faad14 0%, #52c41a 100%);\n          transition: width 0.3s ease;\n        }\n\n        .suggestion-button {\n          opacity: 0;\n          transition: opacity 0.2s ease;\n        }\n\n        .suggestion-item:hover .suggestion-button {\n          opacity: 1;\n        }\n\n        .suggestion-description {\n          margin: 4px 0;\n        }\n\n        .suggestion-tags {\n          margin: 4px 0;\n        }\n\n        .suggestion-reason {\n          margin-top: 4px;\n          padding-top: 4px;\n          border-top: 1px solid #f0f0f0;\n        }\n\n        @keyframes clickFeedback {\n          0% { transform: scale(1); }\n          50% { transform: scale(0.95); }\n          100% { transform: scale(1); }\n        }\n\n        .suggestion-clicked {\n          animation: clickFeedback 0.3s ease;\n        }\n\n        @media (max-width: 768px) {\n          .suggestion-header {\n            flex-direction: column;\n            align-items: flex-start;\n            gap: 4px;\n          }\n\n          .suggestion-actions {\n            align-self: flex-end;\n          }\n        }\n      `})]});};export default SmartLinkSuggestions;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}